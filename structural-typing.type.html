<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>structural-typing.type documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Structural-typing 2.0.2 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>structural-typing</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>assist</span></div></div></li><li class="depth-3 branch"><a href="structural-typing.assist.defaults.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>defaults</span></div></a></li><li class="depth-3 branch"><a href="structural-typing.assist.lifting.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lifting</span></div></a></li><li class="depth-3 branch"><a href="structural-typing.assist.oopsie.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oopsie</span></div></a></li><li class="depth-3 branch"><a href="structural-typing.assist.predicate-defining.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>predicate-defining</span></div></a></li><li class="depth-3 branch"><a href="structural-typing.assist.special-words.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>special-words</span></div></a></li><li class="depth-3 branch"><a href="structural-typing.assist.testutil.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>testutil</span></div></a></li><li class="depth-3"><a href="structural-typing.assist.type-repo.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>type-repo</span></div></a></li><li class="depth-2 branch"><a href="structural-typing.doc.html"><div class="inner"><span class="tree" style="top: -238px;"><span class="top" style="height: 247px;"></span><span class="bottom"></span></span><span>doc</span></div></a></li><li class="depth-2 branch"><a href="structural-typing.global-type.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>global-type</span></div></a></li><li class="depth-2 branch"><a href="structural-typing.preds.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>preds</span></div></a></li><li class="depth-2 current"><a href="structural-typing.type.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>type</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="structural-typing.type.html#var-.3C.3Eall-built-like"><div class="inner"><span>&lt;&gt;all-built-like</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-.3C.3Ebuilt-like"><div class="inner"><span>&lt;&gt;built-like</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-ALL"><div class="inner"><span>ALL</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-all-built-like"><div class="inner"><span>all-built-like</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-built-like"><div class="inner"><span>built-like</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-built-like.3F"><div class="inner"><span>built-like?</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-default-error-handler"><div class="inner"><span>default-error-handler</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-default-success-handler"><div class="inner"><span>default-success-handler</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-description"><div class="inner"><span>description</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-each-of"><div class="inner"><span>each-of</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-empty-type-repo"><div class="inner"><span>empty-type-repo</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-ensure-standard-functions"><div class="inner"><span>ensure-standard-functions</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-explain-with"><div class="inner"><span>explain-with</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-includes"><div class="inner"><span>includes</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-named"><div class="inner"><span>named</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-not-nil"><div class="inner"><span>not-nil</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-origin"><div class="inner"><span>origin</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-paths-of"><div class="inner"><span>paths-of</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-RANGE"><div class="inner"><span>RANGE</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-reject-missing"><div class="inner"><span>reject-missing</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-reject-nil"><div class="inner"><span>reject-nil</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-replace-error-handler"><div class="inner"><span>replace-error-handler</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-replace-success-handler"><div class="inner"><span>replace-success-handler</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-required-path"><div class="inner"><span>required-path</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-requires"><div class="inner"><span>requires</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-requires-mentioned-paths"><div class="inner"><span>requires-mentioned-paths</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-show-as"><div class="inner"><span>show-as</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-through-each"><div class="inner"><span>through-each</span></div></a></li><li class="depth-1"><a href="structural-typing.type.html#var-throwing-error-handler"><div class="inner"><span>throwing-error-handler</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">structural-typing.type</h2><div class="doc"><div class="markdown"><p>Structural types, loosely inspired by Elm&rsquo;s way of looking at <a href="http://elm-lang.org/learn/Records.elm">records</a>.</p></div></div><div class="public anchor" id="var-.3C.3Eall-built-like"><h3>&lt;&gt;all-built-like</h3><div class="usage"><code>(&lt;&gt;all-built-like candidates type-repo type-shorthand)</code><code>(&lt;&gt;all-built-like candidates type-shorthand)</code></div><div class="doc"><div class="markdown"><p>The same as <a href="structural-typing.type.html#var-all-built-like">all-built-like</a> but intended to be used in <code>-&gt;</code> pipelines. Consequently, the <code>candidates</code> argument comes first.</p>
<pre><code>  (-&gt; emr-patients
      augment           (&lt;&gt;all-built-like [:Decidable Patient])
      audit
      decide
      schedule)
</code></pre><p>(The <code>&lt;&gt;</code> is intended to remind you of <a href="https://github.com/rplevy/swiss-arrows">swiss arrows</a>.)</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L118">view source</a></div></div><div class="public anchor" id="var-.3C.3Ebuilt-like"><h3>&lt;&gt;built-like</h3><div class="usage"><code>(&lt;&gt;built-like candidate type-repo type-shorthand)</code><code>(&lt;&gt;built-like candidate type-shorthand)</code></div><div class="doc"><div class="markdown"><p>The same as <a href="structural-typing.type.html#var-built-like">built-like</a> but intended to be used in <code>-&gt;</code> pipelines. Consequently, the <code>candidate</code> argument comes first.</p>
<pre><code>  (-&gt; emr-patient
      augment           (&lt;&gt;built-like [:Decidable Patient])
      audit
      decide
      schedule)
</code></pre><p>(The <code>&lt;&gt;</code> is intended to remind you of <a href="https://github.com/rplevy/swiss-arrows">swiss arrows</a>.)</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L79">view source</a></div></div><div class="public anchor" id="var-ALL"><h3>ALL</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>When included in a path, expects a collection and applies the rest of the path to each element.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/compile/compile_path.clj#L168">view source</a></div></div><div class="public anchor" id="var-all-built-like"><h3>all-built-like</h3><div class="usage"><code>(all-built-like type-repo type-shorthand candidates)</code><code>(all-built-like type-shorthand candidates)</code></div><div class="doc"><div class="markdown"><p>Check each of the <code>candidates</code>. Perform the <code>type-repo</code>&rsquo;s error behavior if <em>any</em> of the candidates fail. Otherwise, return the original <code>candidates</code>.</p>
<pre><code>(some-&gt;&gt; (all-built-like :Point [{:x 1, :y 2}
                                 {:why &quot;so serious?&quot;}])
         (map process-points))
</code></pre><p>Error messages will include the index of the structure that failed.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L96">view source</a></div></div><div class="public anchor" id="var-built-like"><h3>built-like</h3><div class="usage"><code>(built-like type-repo type-shorthand candidate)</code><code>(built-like type-shorthand candidate)</code></div><div class="doc"><div class="markdown"><p><code>type-shorthand</code> is either a type-signifier (typically a keyword like <code>:Point</code>), a condensed type description (like <code>(requires :x :y)</code>), or a vector containing either or both. <code>built-like</code> checks the <code>candidate</code> against the shorthand. </p><p>By default, <code>built-like</code> will either return the <code>candidate</code> or, if the candidate doesn&rsquo;t match the shorthand, print an error message and return <code>nil</code>. If the <code>type-repo</code> is omitted, the global one is used.</p>
<pre><code>(type/built-like :Point {:x 1 :y 2})
(type/built-like [:Colorful :Point] {:x 1, :y 2, :color &quot;red&quot;})
(type/built-like [:Colorful (requires :x :y)] {:x 1, :y 2, :color &quot;red&quot;})
</code></pre><p>Types are defined with <a href="structural-typing.type.html#var-named">named</a> or <a href="structural-typing.global-type.html#var-type.21">type!</a>. Default behavior is changed with <a href="structural-typing.type.html#var-replace-success-handler">replace-success-handler</a>, <a href="structural-typing.type.html#var-replace-error-handler">replace-error-handler</a>, <a href="structural-typing.global-type.html#var-on-success.21">on-success!</a>, and <a href="structural-typing.global-type.html#var-on-error.21">on-error!</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L56">view source</a></div></div><div class="public anchor" id="var-built-like.3F"><h3>built-like?</h3><div class="usage"><code>(built-like? type-repo type-shorthand candidate)</code><code>(built-like? type-shorthand candidate)</code></div><div class="doc"><div class="markdown"><p><code>type-shorthand</code> is either a type-signifier (typically a keyword like <code>:Point</code>), a condensed type description (like <code>(requires :x :y)</code>), or a vector containing either or both.</p><p>Returns <code>true</code> iff the <code>candidate</code> structure matches everything in the shorthand.</p><p>With three arguments, the check is against the <code>type-repo</code>. If <code>type-repo</code> is omitted, the global repo is used.</p>
<pre><code>(type/built-like? :Point candidate)
(type/built-like? [:Colorful :Point] candidate)
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L144">view source</a></div></div><div class="public anchor" id="var-default-error-handler"><h3>default-error-handler</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>This error handler takes the output of type checking (a sequence of <a href="structural-typing.assist.oopsie.html#var-oopsies">oopsies</a>) and prints each one&rsquo;s explanation to standard output. It returns <code>nil</code>, allowing constructs like this:</p>
<pre><code> (some-&gt; (type/built-like :Patient p)
         (assoc :handled true)
         ...)
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/assist/defaults.clj#L21">view source</a></div></div><div class="public anchor" id="var-default-success-handler"><h3>default-success-handler</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>The default success handler just returns the original candidate structure passed to <code>built-like</code>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/assist/defaults.clj#L17">view source</a></div></div><div class="public anchor" id="var-description"><h3>description</h3><div class="usage"><code>(description type-repo type-signifier)</code><code>(description type-signifier)</code></div><div class="doc"><div class="markdown"><p>Returns the canonical (expanded) description of the <code>type-signifier</code>. Uses the global type repo if none is given. </p><p>The result is not a string, but rather a structure tweaked to look nice either at the repl or as the output from <code>pprint</code>. However, that means it&rsquo;s not a real type description; you can&rsquo;t feed it back to <a href="structural-typing.type.html#var-named">named</a> or <a href="structural-typing.global-type.html#var-type.21">type!</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L175">view source</a></div></div><div class="public anchor" id="var-each-of"><h3>each-of</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Use <code>each-of</code> to describe a &ldquo;forking&rdquo; path. This is convenient when two parts of a bigger data structure should be built the same way.</p>
<pre><code>(type! :Plat {[:corners (each-of :nw :ne :sw :se)] (includes :GeoPoint)})
</code></pre><p><a href="structural-typing.type.html#var-through-each">through-each</a> is a synonym. I tend to use <code>each-of</code> for the end of the path, <code>through-each</code> for a fork earlier than that.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/type_descriptions/flatten.clj#L49">view source</a></div></div><div class="public anchor" id="var-empty-type-repo"><h3>empty-type-repo</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>A type repo that contains no types and uses the default success and error handlers.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/assist/type_repo.clj#L60">view source</a></div></div><div class="public anchor" id="var-ensure-standard-functions"><h3>ensure-standard-functions</h3><h4 class="type">macro</h4><div class="usage"><code>(ensure-standard-functions type-repo-sym)</code></div><div class="doc"><div class="markdown"><p>Suppose you are creating a type repo inside a namespace, as is done in  the <a href="https://github.com/marick/structural-typing/blob/master/examples/timbre_define_1.clj">logging example</a>. You&rsquo;d like that namespace to provide functions that use that type repo  without having to constantly refer to it:</p>
<pre><code> (my.types/built-like? :Point xy)
 ;; instead of:
 (my.types/built-like? my.types/type-repo :Point xy)
</code></pre><p>This function takes a type repo and creates type-repo-specific functions for you.</p>
<pre><code> (in-ns &#39;my.types)
 (type/ensure-standard-functions type-repo)
</code></pre><p>See <a href="https://github.com/marick/structural-typing/blob/master/examples/definition.clj">the examples directory</a> more details.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L199">view source</a></div></div><div class="public anchor" id="var-explain-with"><h3>explain-with</h3><div class="usage"><code>(explain-with explainer predicate)</code></div><div class="doc"><div class="markdown"><p>After the <code>predicate</code> fails, the failure will need to be explained. Arrange for <code>explainer</code> to be called with the <a href="structural-typing.assist.oopsie.html#var-oopsie">oopsie</a> that results from the failure.</p>
<pre><code> (explain-with #(format &quot;Yo! %s has %s characters, which is WAY too long.&quot;
                        (:leaf-value %)
                        (count (:leaf-value %)))
               #(&lt; (count %) 8)))
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/preds/annotating.clj#L19">view source</a></div></div><div class="public anchor" id="var-includes"><h3>includes</h3><div class="usage"><code>(includes type-signifier)</code></div><div class="doc"><div class="markdown"><p>During creation of a type by <a href="structural-typing.type.html#var-named">named</a> or <a href="structural-typing.global-type.html#var-type.21">type!</a>, a call to <code>includes</code> is replaced with the type the <code>type-signifier</code> refers to.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/type_descriptions/type_expander.clj#L28">view source</a></div></div><div class="public anchor" id="var-named"><h3>named</h3><div class="usage"><code>(named type-repo type-signifier &amp; condensed-type-descriptions)</code></div><div class="doc"><div class="markdown"><p>Define <code>type-signifier</code> inside the <code>type-repo</code> in terms of the <code>condensed-type-descriptions</code>.</p><p>Returns the augmented <code>type-repo</code>. See also <a href="null">named!</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L135">view source</a></div></div><div class="public anchor" id="var-not-nil"><h3>not-nil</h3><div class="usage"><code>(not-nil &amp; args)</code></div><div class="doc"><div class="markdown"><p>WARNING: #&rsquo;structural-typing.guts.preds.pseudopreds/not-nil is deprecated. Deprecated in favor of <code>required-path</code>, <code>reject-nil</code>, or <code>reject-missing</code>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/preds/pseudopreds.clj#L103">view source</a></div></div><div class="public anchor" id="var-origin"><h3>origin</h3><div class="usage"><code>(origin type-repo type-signifier)</code><code>(origin type-signifier)</code></div><div class="doc"><div class="markdown"><p>Returns the original condensed type description associated with the <code>type-signifier</code>. Uses the global type repo if none is given.</p><p>The result is not a string, but rather a structure tweaked to look nice either at the repl or as the output from <code>pprint</code>. However, that means it&rsquo;s not a real type description; you can&rsquo;t feed it back to <a href="structural-typing.type.html#var-named">named</a> or <a href="structural-typing.global-type.html#var-type.21">type!</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L161">view source</a></div></div><div class="public anchor" id="var-paths-of"><h3>paths-of</h3><div class="usage"><code>(paths-of type-signifier-or-map)</code></div><div class="doc"><div class="markdown"><p>Include all the paths of a type (or a literal map) within a path.</p>
<pre><code> (type! :StrictX (includes :X)
                 (requires (paths-of :X)))
</code></pre><p>The above example constructs a stricter version of <code>:X</code> by insisting all of its paths are required.</p><p>When the argument is a map, it is flattened before the paths are extracted, so that <code>{:a {:b even?}}</code> and <code>{[:a :b] even?}</code> have the same effect. (Included types are already flat.)</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/type_descriptions/flatten.clj#L59">view source</a></div></div><div class="public anchor" id="var-RANGE"><h3>RANGE</h3><div class="usage"><code>(RANGE inclusive-start exclusive-end)</code></div><div class="doc"><div class="markdown"><p>Use this in a path to select a range of values in a collection. The first argument is inclusive; the second exclusive.</p>
<pre><code>(type! :ELEMENTS-1-AND-2-ARE-EVEN {[(RANGE 1 3)] even?})
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/compile/compile_path.clj#L257">view source</a></div></div><div class="public anchor" id="var-reject-missing"><h3>reject-missing</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>This appears in a predicate list, but it is never called directly. Its appearance means that cases like the following are rejected:</p>
<pre><code>user=&gt; (type! :X {:a [string? reject-missing]})
user=&gt; (built-like :X {})
:a does not exist

user=&gt;  (type! :X {[(RANGE 0 3)] [reject-missing even?]})
user=&gt; (built-like :X [])
[0] does not exist
[1] does not exist
[2] does not exist
</code></pre><p>See also <a href="structural-typing.type.html#var-reject-nil">reject-nil</a> and <a href="structural-typing.type.html#var-required-path">required-path</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/preds/pseudopreds.clj#L54">view source</a></div></div><div class="public anchor" id="var-reject-nil"><h3>reject-nil</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>False iff the value given is <code>nil</code>. By default, type descriptions allow nil values, following Clojure&rsquo;s lead. To reject nils, use type descriptions like this:</p>
<pre><code>(type! :X {:a [reject-nil string?]})
</code></pre><p>&hellip; or, when checking types directly:</p>
<pre><code>(built-like [string? reject-nil] nil)
</code></pre><p>See also <a href="structural-typing.type.html#var-reject-missing">reject-missing</a> and <a href="structural-typing.type.html#var-required-path">required-path</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/preds/pseudopreds.clj#L24">view source</a></div></div><div class="public anchor" id="var-replace-error-handler"><h3>replace-error-handler</h3><div class="usage"><code>(replace-error-handler type-repo handler)</code></div><div class="doc"><div class="markdown"><p>For this <code>type-repo</code>, pass <a href="structural-typing.assist.oopsie.html#var-oopsies">oopsies</a> generated by type failures to <code>handler</code> as the last step in <a href="structural-typing.type.html#var-built-like">built-like</a>. Thus, <code>built-like</code> will return the handler&rsquo;s result.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L19">view source</a></div></div><div class="public anchor" id="var-replace-success-handler"><h3>replace-success-handler</h3><div class="usage"><code>(replace-success-handler type-repo handler)</code></div><div class="doc"><div class="markdown"><p>For this <code>type-repo</code>, handle candidates that typecheck successfully by passing them to <code>handler</code> as the last step in <a href="structural-typing.type.html#var-built-like">built-like</a>. Thus, <code>built-like</code> will return the handler&rsquo;s result.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/type.clj#L19">view source</a></div></div><div class="public anchor" id="var-required-path"><h3>required-path</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>False iff a key/path does not exist or has value <code>nil</code>. See also <a href="structural-typing.type.html#var-reject-missing">reject-missing</a> and <a href="structural-typing.type.html#var-reject-nil">reject-nil</a>.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/preds/pseudopreds.clj#L42">view source</a></div></div><div class="public anchor" id="var-requires"><h3>requires</h3><div class="usage"><code>(requires &amp; args)</code></div><div class="doc"><div class="markdown"><p>Often, all you want to say about some parts of a type is that they&rsquo;re required. <code>requires</code> is a shorthand way to do that.</p>
<pre><code>(type! :Point (requires :x :y))
(type! :Line (requires [:start :x] [:start :y]))
(type! :Line (requires [(through-each :start :end) (:each-of :x :y)]))
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/type_descriptions/ppps.clj#L14">view source</a></div></div><div class="public anchor" id="var-requires-mentioned-paths"><h3>requires-mentioned-paths</h3><div class="usage"><code>(requires-mentioned-paths &amp; condensed-type-descriptions)</code></div><div class="doc"><div class="markdown"><p>Canonicalizes the type descriptions into a single path-&gt;pred map and adds <a href="structural-typing.type.html#var-required-path">required-path</a> to each path&rsquo;s predicates.</p>
<pre><code> (type! :X (requires-mentioned-paths (includes :Point)
                                     {:color rgb-string?}))
</code></pre><p>Note: It can&rsquo;t require paths you don&rsquo;t mention. The easiest way to mention a path is to name it in a <code>requires</code> - which may be either an argument to this function or outside it:</p>
<pre><code> (type! :X (requires-mentioned-paths (requires :name)
                                     (includes :Point)))
 (type! :X (requires :name)
           (requires-mentioned-paths (includes :Point)))
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/type_descriptions.clj#L22">view source</a></div></div><div class="public anchor" id="var-show-as"><h3>show-as</h3><div class="usage"><code>(show-as name predicate)</code></div><div class="doc"><div class="markdown"><p>Associate the given <code>name</code> string with the predicate for use when predicate failures are explained.</p>
<pre><code>  (show-as &quot;less than 3&quot; (partial &gt;= 3))
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/preds/annotating.clj#L6">view source</a></div></div><div class="public anchor" id="var-through-each"><h3>through-each</h3><div class="usage"><code>(through-each &amp; alternatives)</code></div><div class="doc"><div class="markdown"><p>Use <code>through-each</code> to describe a &ldquo;forking&rdquo; path. This is convenient when two parts of a bigger data structure should be built the same way.</p>
<pre><code>(type! :Line {[(through-each :start :end) :location] (includes :Point)})
</code></pre><p><a href="structural-typing.type.html#var-each-of">each-of</a> is a synonym. I tend to use <code>each-of</code> for the end of the path, <code>through-each</code> for a fork earlier than that.</p></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/guts/type_descriptions/flatten.clj#L39">view source</a></div></div><div class="public anchor" id="var-throwing-error-handler"><h3>throwing-error-handler</h3><div class="usage"><code>(throwing-error-handler oopsies)</code></div><div class="doc"><div class="markdown"><p>In contrast to the default error handler, this one throws a <code>java.lang.Exception</code> whose message is the concatenation of the <a href="structural-typing.assist.oopsie.html#var-explanations">explanations</a> of the <a href="structural-typing.assist.oopsie.html#var-oopsies">oopsies</a>.</p><p>To make all type mismatches throw failures, do this:</p>
<pre><code>   (global-type/on-error! type/throwing-error-handler) ; for the global type repo
   (type/replace-error-handler type-repo type/throwing-error-handler) ; local repo
</code></pre></div></div><div class="src-link"><a href="https://github.com/marick/structural-typing/blob/master/src/structural_typing/assist/defaults.clj#L32">view source</a></div></div></div></body></html>